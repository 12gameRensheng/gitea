<h4 class="ui top attached header">
	{{.Title}}
	<div class="ui right">
		<div class="ui jump dropdown">
			<div class="ui primary tiny button">{{.locale.Tr "repo.settings.add_webhook"}}</div>
			<div class="menu">
				<a class="item" href="{{.BaseLinkNew}}/gitea/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/gitea.svg">{{.locale.Tr "repo.settings.web_hook_name_gitea"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/gogs/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/gogs.ico">{{.locale.Tr "repo.settings.web_hook_name_gogs"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/slack/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/slack.png">{{.locale.Tr "repo.settings.web_hook_name_slack"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/discord/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/discord.png">{{.locale.Tr "repo.settings.web_hook_name_discord"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/dingtalk/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/dingtalk.ico">{{.locale.Tr "repo.settings.web_hook_name_dingtalk"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/telegram/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/telegram.png">{{.locale.Tr "repo.settings.web_hook_name_telegram"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/msteams/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/msteams.png">{{.locale.Tr "repo.settings.web_hook_name_msteams"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/feishu/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/feishu.png">{{.locale.Tr "repo.settings.web_hook_name_feishu_or_larksuite"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/matrix/new">
					{{svg "gitea-matrix" 20 "img"}}{{.locale.Tr "repo.settings.web_hook_name_matrix"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/wechatwork/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/wechatwork.png">{{.locale.Tr "repo.settings.web_hook_name_wechatwork"}}
				</a>
				<a class="item" href="{{.BaseLinkNew}}/packagist/new">
					<img width="20" height="20" src="{{AssetUrlPrefix}}/img/packagist.png">{{.locale.Tr "repo.settings.web_hook_name_packagist"}}
				</a>
			</div>
		</div>
	</div>
</h4>
<div class="ui attached segment">
	<script>
		const WebhooksHookTast = {{.WebhooksHookTast}};

		const WebhooksIdS = {{.WebhooksIdS}};

		const WebhookList = {{.Webhooks}};
		const desc = '{{.locale.Tr "repo.settings.webhook.updated_unix"}}';
		window.onload = () => {
			if(WebhookList) {
				WebhookList.forEach(item => {
					$("#time-" + item.ID).text(desc + ":" + new Date(item.UpdatedUnix * 1000).toLocaleString());
				});
			}

			if(WebhooksIdS && WebhooksIdS.length > 0 && WebhooksHookTast) {
				const WebhooksHookTastKeys = {};
				WebhooksHookTast.forEach(item => {
					WebhooksHookTastKeys[item.HookID] = item;
				})

				WebhooksIdS.forEach(id => {
					if (!WebhooksHookTastKeys[id]) {
						$("#Webhook-history-author-" + id).hide()
						$("#Webhook-history-author-img-" + id).hide()
						return ;
					}
					const PayloadContent = JSON.parse(WebhooksHookTastKeys[id].PayloadContent);

					$("#Webhook-history-author-" + id).text(PayloadContent.pusher.login ? PayloadContent.pusher.login : PayloadContent.pusher.login_name);
					$("#Webhook-history-author-" + id).attr("href", PayloadContent.pusher.login);
					$("#Webhook-history-author-img-" + id).attr("src", PayloadContent.pusher.avatar_url);
				});
			}
		}
	</script>
	<div class="ui list">
		<div class="item">
			{{.Description | Str2html}}
		</div>
		{{range .Webhooks}}
			<div class="item truncated-item-container">
				<span class="text {{if eq .LastStatus 1}}green{{else if eq .LastStatus 2}}red{{else}}grey{{end}} gt-mr-3">{{svg "octicon-dot-fill" 22}}</span>
				<a class="text truncate gt-f1 gt-mr-3" title="{{.URL}}" href="{{$.BaseLink}}/{{.ID}}">{{.URL}}</a>
				<a id="Webhook-history-author-{{.ID}}" href="/">加载中...</a>&nbsp;
				<img id="Webhook-history-author-img-{{.ID}}" class="ui avatar gt-vm tiny" src="/avatars/b0b07e5bacd5d60fa7b11f05979c937070d92dc3a7e1e85101c6c01d52d5cd29?size=48" title="zengye" width="24" height="24">&nbsp;
				<span id="time-{{.ID}}" class="text grey time"></span>
				<a class="muted gt-p-3" href="{{$.BaseLink}}/{{.ID}}">{{svg "octicon-pencil"}}</a></span>
				<a class="delete-button gt-p-3" data-url="{{$.Link}}/delete" data-id="{{.ID}}">{{svg "octicon-trash"}}</a>
			</div>
		{{end}}
	</div>
</div>
